---
title: "MATH 396 - Assignment"
author: "Trevor Dallow"
date: "April 17, 2017"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Question 1
Draw the bifurcation diagram for fa(x) = x^3 + ax. Make sure you indicate which segments correspond to stable and unstable periodic orbits. (Note: the bifurcation diagram contains all periodic points, not just the fixed points.)

f' = 3x^2 + a

Solve:
f' = 1  => 3x^2 + a = 1
f = x   => x^3 + ax

a = 1, x = 0

When a >= 1, there is one fixed point, when a < 1, there are 3 fixed points, there are no other periodic points. As lim a -> 1^-, two fixed points merge towards a third fixed point at x = 0 at the ciritical value (bifurcation point) a = 1. Continuing to increase a from 1 yields no change in the position of the fixed point. 

When a = 1, there is one fixed point, of neither stability.
When a > 1, there is one unstable, fixed point.
When a < 1 there is one stable fixed point (at x = 0) and two unstable fixed points. 

```{r}
a = -1:1
x = seq(from = -2, to = 2, by = .01)

plot(x, x, type = "l", main = "x^3+ax for various a and degrees", ylab = "f")
grid(nx = 2, ny = 2)

f = function(a, x) {
  x^3+a*x
}

for (i in 1:length(a)) {
  lines(x, f(a[i], x), col = i + 1, lty = 1)
}

for (i in 1:length(a)) {
  lines(x, f(a[i], f(a[i], x)), col = i + 1, lty = 2)
}

legend("topleft", c(paste0("a(", a, ") n(1)"), paste0("a(", a, ") n(2)")), col = 2:(length(a) + 1), pch = c("_", "_", "_", "-", "-", "-"), title = "f^n_a")
```

```{r}
a = seq(from = -5, to = 5, by = 0.1)

f2 = function(a, x) {
  f(a,x)^3+a*f(a,x)
}

z<-outer(a, x, f)
contour(a,x,z, nlevels = 0, xlab = "a", ylab = "p", main = "Partial Bifurcation Diagram", drawlabels = F, col = 1)
z2<-outer(a, x, f2)
contour(a, x, z2, nlevels = 0, xlab = "a", ylab = "p", main = "Partial Bifurcation Diagram", add = T, drawlabels = F, col = 2)
grid(nx = 2, ny = 2)
legend("topright", c("f^1", "f^2"), pch = "_", col = 1:2)
```

Plot partial bifurcation diagram and indicate segments that correspond to stable and unstable periodic orbits.

Question 2
...

Question 3
Refer to Chapter 2 notes (pages 10,11) to prove that if a is a bifurcation point of fa(x), then dxfa(x) = 1 at a = -a; x = p_-a (here we write the fixed point as p(a) to exhibit its dependence on a). 

Also, at a period doubling bifurcation point -a of f_a, that necessarily dxf_a(x) = -1 at a = -a, x = p_-a. And note that this is what we observe
graphically (see the notes page 4 Lecture 2 and page 28 of the presentation that is posted in the 'Lectures' folder on Canvas (at the top!).

Question 5
Shadow Lines
(a) Why doesn't the diagram have points from the bottom (x = 0) to the top (x = 1)? That is, although fa(x) is defined on the entire interval [0, 1], we only see points in the final state diagram in a smaller subinterval.

The diagram is not defined over the entirety of its interval [0, 1] because the maximal value for the logistic equation is a/4 for varying a [0, 4]. No points exist in the diagram for values > a/4. As well, no points exist below a lower boundary of f(v_a) where v_a = f(0.5) for te logistic equation.

(b) Determine the curves where there is a higher density of points in the final state diagram and plot them. 

Let v_a = f_a(0.5) denote the upper bpoundary of the final state diagram of the logistic equation, as well as the highest peak in the density histogram. Further, let f_a(v_a), f_a^2(v_a), f_a^3(v_a) the curves of the next highest peaks in the density histogram. The reason for the prominance of these points is that the peaks of the density histogram indicate the points that define the shadow lines. 
```{r}
a = seq(from = 0, to = 4, by = .001)
x = .5
n = 5
f = a*x*(1-x)
plot(a, f, type = 'n', xlim = c(3,4), ylim = c(0,1), main = "Shadow Lines of Logistic Equation")
for (i in 1:n) {
  lines(a, f, col = i)
  f = a*f*(1-f)
}
legend("bottomleft", c("v", paste0("f^", 1:(n-1))), pch = "_", col = 1:n)
```

Question 8
A dynamical system depends on a parameter a. Initially, you observe
a steady state (i.e., a period 1 orbit). As a increases you observe a period 2 oscillation appearing at a = a[1] = 7. Then at a = a[2] = 10 you observe that the period 2 orbits splits into a period 4 orbit. As a continues to increase a series of period-doublings occurs. Assuming Universality, at what a value would you expect to observe the onset of chaos? ('Assuming Universality' means assuming that the system will go through a series of period-doubling bifurcations as the parameter a changes, and that the distance (in a) between bifurcations is given by the Feigenbaum constant.)

Observed chaos can be expected to happen when a exceeds the Figenbaum constant a_inf. Also we know that the rate at which bifurcations occur is the same for many dynamical systems, so assuming that this system behaves similarily to the logistic equation, we may use the rates at which the logistic equation bifurcates to help us determine the value that we expect to see observed chaos.
```{r}
a = matrix(NA, nrow = 7)
p = matrix(NA, nrow = 7)
d = matrix(NA, nrow = 7)
r = matrix(NA, nrow = 7)

a[2] = 7
a[3] = 10
p[1] = 1
d[3] = a[3] - a[2]
r[3] = 4.7514
r[4] = 4.6562
r[5] = 4.6682
r[6] = 4.6687
r[7] = 4.6693
for (i in 2:length(p)) {
  p[i] = p[i - 1] * 2
}

for (i in 4:length(r)) {
  d[i] = (1 / r[i]) * d[i - 1]
  a[i] = d[i] + a[i - 1]
}

BifPointTab = cbind(a, p, d, r)
colnames(BifPointTab) = c("Bifurcation Point", "Period", "Difference", "Ratio")
BifPointTab

print(paste0("Approx. value of a where chaos can be observed: ~", BifPointTab[7, 1]))
```

We need more ratios and further analysis to find a better approximation than ~10.8182, the true value would be slightly larger than this value.



